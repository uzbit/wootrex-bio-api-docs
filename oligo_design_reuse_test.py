import requests
import time
import base64
import mimetypes


def readFileAndEncode(filePath, name, type):
    designFileData = []
    try:
        with open(filePath, "rb") as file:
            fileData = file.read()
            encodedData = base64.b64encode(fileData).decode("ascii")
            designFileData.append([name, encodedData, type])
    except Exception as e:
        print(f"Error reading or encoding file: {e}")
    return designFileData


# Example usage:
filePath = "design01.xlsx"  # Replace with your file path
name = "design01.xlsx"
type, _ = mimetypes.guess_type(filePath)

designFileData = readFileAndEncode(filePath, name, type)

# Print the designFileData to verify
print(designFileData)

url = "https://homologypath.com/router/"
token = "YOUR_API_TOKEN_HERE"
data = {
    "api": "oligo_design",
    # "hostname": "localhost",
    "required_parameters": {
        "sequences": [
            {
                "sequence_name": "example1",
                "sequence": "TTTCATAACTATACTCGTAAGGATCATGTTATTGATTTCTTCAAAGGTTACTGTGGGTCTCCGGGCCCCCCCGTCCACCCAGACCGACCGAACTCTCCCGTTTAGGACCCTAGTAAGTCATCATTGGTATATGAATGCGACCCCGAAGAACTGTGGGTCTCCGGGCCCCCCCGTCCACCCAGACCGACCGAACTCTCCCGCAATTCTATAAGAATGCACACTGCATCGATACATAAAACGTCTCGATCGCGCCGGGAAAGGTACGCACGCGGTATATACCGCGTGCGTACCTTTCCCGGCTCCTTCCAGAGGTATGTGGCTGCGTGGTCAAAAGTGCGGCATTCGTATTTGCTCCTCGTGTTTACTCTCACAAACTTGACCTGGAGATCAAGGAGATGCTTCTTGTGGAACTGGACAACGCAACGACGACGACGACG",
                "primer_length": "20",
            },
            {
                "sequence_name": "example2",
                "sequence": "ATGCCGGACGGATCCGGATCTCGCGGGATTTTCATAACTATACTCGTAAGGATCATGTTATTGATTTCTTCAAAGGTTACTGTGGGTCCTCGCACCGGATCCGGATCGTCCGGATCGCGAAATGCCGGACGGATCCGGATCTCGCGGGATCTCGCACCGGATCCGGATCGTCCGGATCGCGAA",
                "primer_length": "20",
            },
        ],
        "oligo_design_parameters": {
            "design_type": "maximize_recycling",
            "minimum_length": "30",
            "target_length": "50",
            "maximum_length": "60",
            "minimum_overlap": "15",
            "maximum_overlap": "30",
        },
        "primer_design_parameters": {
            "target_primer_length": "20",
            "tm_optimize_primers": "true",
        },
    },
    "optional_parameters": {
        "design_name": "design01",
        "source_plate_size": "384",
        "destination_plate_size": "384",
        "emails": "your@email.com",
        "row_major": "true",
        "recycle_oligos": "true",
        "partition_identity": "0.95",
        "compute_complexity_for_design": "false",
        # "custom_cuts": {"example1": ["25"]},
        "temp": "60",
        "design_files": [
            [
                "design01.xlsx",
                "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",
                "application/vnd.openxmlformats-officedocument.spreadsheetml.sheet",
            ]
        ],
    },
}

# Post a request with job info to the API.
print("Posting request (worker starting may take some time)...")
response = requests.post(
    url,
    headers={"Authorization": f"Token {token}"},
    json=data,
)
print(response)
data = response.json()

# At this point "job_id" field means the worker is booted and computing.
print("Response:", data)

# Depending on how big the request was, you should periodically poll the API with "job_id".
# This example just sleeps for 10 seconds, which is enough time to finish the calculations.
time.sleep(10)

# Poll the API to get the job results.
print(f"Checking {data} for results...")
data["api"] = "oligo_design"
# data["hostname"] = "localhost"
response = requests.post(
    url,
    headers={"Authorization": f"Token {token}"},
    json=data,
)
response = response.json()

# A polling response with successful execution will have a "Finished" field with the "job_id".
if "Finished" in response:
    print(f"Finished {data} with:\n{response}")
elif "Queued" in response:
    print(f"Job queued to execute.")
elif "Failed" in response:
    print(f"Job failed with {response['Failed']}!")
elif "Processing" in response:
    print(f"Job is currently executing.")
elif "Error" in response:
    print(f"Job in an unknown state! {response['Error']}")

print("")
print("Reuse Efficiency", response["Design Info"]["Reuse efficiency"])
